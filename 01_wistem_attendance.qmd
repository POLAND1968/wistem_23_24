---
title: "WiSTEM 2023 - 2024"
subtitle: "Attendance Analysis"
format:
  html:
    toc: true
    embed-resources: true
    echo: false
    link-external-newwindow: true
execute:
  warning: false
  message: false
from: markdown+emoji  
editor: 
  markdown: 
    wrap: 72
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: load-packages

library(tidyverse)
library(patchwork)
library(readr)
library(kableExtra)

set.seed(1968)
```

```{r}
#| label: load-data-set

# Load Data
wistem_attendance_data <- read_csv(file = "data/processed/wistem_2324_attendance_processed.csv")

# Leveling
wistem_attendance_data$date <- factor(wistem_attendance_data$date, levels = c("Sep 29th", "Oct 13th", "Oct 27th", "Nov 15th", "Nov 17th", "Dec 1st", "Dec 15th", "Jan 18th", "Jan 19th", "Feb 16th", "Mar 1st", "Mar 15th", "Apr 5th", "Apr 19th", "May 3rd"))

# Colors
color <- c("#716C6B")
fill <- c("#B6ACD1")

unique_colors <- c("lavender", "darkseagreen2", "lightpink2", "khaki", "lightcyan2", "peachpuff")
```

# Background

**WiSTEM:** In total, there were 15 overall WiSTEM meetings held throughout the 2023-2024 academic school year. There were 14 meetings with attendance data and 14 meetings with exit slip data. There is an overlap in the meeting missing both attendance and exit slip data.

**Attendance Distribution:** On average, 78.33 students attended each WiSTEM meeting. The graphs and tables below show the attendance data obtained for each of the 14 meetings where attendance was taken. 

## Attendance Per Meeting
 
```{r}
#| label: attnd-per-meeting

# Graph
ggplot(data = wistem_attendance_data, mapping = aes(y = date)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = 'count', 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.8), 
    family = "Georgia", 
    fontface = "bold"
    ) +
  labs(
    title = "Number of Attendance Per Meeting", 
    subtitle = "With Repeats",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Students", 
    y = "Meeting Date"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Attendance Per Meeting
```{r}
# Table
wistem_attendance_data %>%
  count(date) %>%
  rename(num_students = n) %>% 
  mutate(
    proportion = num_students / sum(num_students), 
    percent = (num_students / sum(num_students)) * 100 
  ) %>%
  kbl(caption = "Number of Attendance Per Meeting") %>%
  kable_styling()
```
:::

## Attendance Per Month
 
```{r}
#| label: attnd-per-month

data_split_date <- wistem_attendance_data[c('month', 'day')] <- str_split_fixed(wistem_attendance_data$date, ' ', 2) %>%
  as_tibble() %>%
  rename(month = V1, day = V2) %>%
  mutate(day = substr(day, 1, 2))

data_split_date$month <- factor(data_split_date$month, levels = c("Sep", "Oct", "Nov", "Dec", "Jan", "Feb", "Mar", "Apr", "May")) 

# Graph
ggplot(data = data_split_date, mapping = aes(y = month)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = 'count', 
    mapping = aes(label=..count..), 
    position = position_stack(vjust = 0.9), 
    family = "Georgia", 
    fontface = "bold"
  ) +
  labs(
    title = "Number of Attendance In Each Month", 
    subtitle = "With Repeats",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Students", 
    y = "Month"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Attendance Per Month
```{r}
# Table
data_split_date %>%
  count(month) %>%
  rename(num_students = n) %>%
  mutate(
    proportion = num_students / sum(num_students), 
    percent = (num_students / sum(num_students)) * 100 
  ) %>%
  kbl(caption = "Number of Attedance In Each Month") %>%
  kable_styling()
```
:::

## Attendance Per Topic
 
```{r}
#| label: attnd-per-topic

# Graph
ggplot(data = wistem_attendance_data %>% mutate(topic = fct_reorder(topic, topic, .fun = length) %>% fct_rev()), mapping = aes(x = topic)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = 'count', 
    mapping = aes(label=..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
  ) +
  scale_y_continuous(breaks = c(0, 100, 200, 300, 400, 500, 600)) +
  scale_x_discrete(guide = guide_axis(angle = 90)) + 
  labs(
    title = "Total Attendance Per Topic Type", 
    subtitle = "With Repeats",
    caption = "Source: WiSTEM 2023-2024",
    x = "Meeting Topic", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Attendance Per Topic
```{r}
# Table
topic_attn_total <- wistem_attendance_data %>%
  count(topic) %>%
  rename(total = n)

topic_attn_total %>%
  mutate(
    proportion = total / sum(total), 
    percent = (total / sum(total)) * 100 
  ) %>%
  kbl(caption = "Total Attendance Per Topic Type") %>%
  kable_styling()
```
:::

## Average Attendance Per Topic
 
```{r}
#| label: avg-attnd-per-topic

topic_meeting_total <- wistem_attendance_data %>%
  select(date, topic) %>%
  unique() %>%
  count(topic) %>%
  rename(meeting_count = n)

avg_topic_data <- full_join(topic_meeting_total, topic_attn_total) %>%
  mutate(
    meeting_avg = total / meeting_count, 
    total_avg = nrow(wistem_attendance_data) / 15 
    )

# Graph
ggplot(data = avg_topic_data, mapping = aes(x = topic, y = meeting_avg)) + 
  geom_col(color = color, fill = fill) + 
  geom_text(
    mapping = aes(label = round(meeting_avg, 2)), 
    position = position_stack(vjust = 0.5),
    family = "Georgia", 
    fontface = "bold"
  ) +
  geom_hline(yintercept = nrow(wistem_attendance_data) / 15) +
  scale_x_discrete(guide = guide_axis(angle = 90)) + 
  labs(
    title = "Average Attendance per Meeting Topic Compared to Overall Average", 
    subtitle = "With Repeats",
    caption = "Source: WiSTEM 2023-2024",
    x = "Meeting Topic", 
    y = "Average Number of Students"
    ) +
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Average Attendance Per Topic
```{r}
# Table
mutate_better_than <- function(avg_topic_data) {
  avg_topic_data %>%
    mutate(benchmark = ifelse(meeting_avg > total_avg, "yes", "no"))
}

avg_topic_data <- mutate_better_than(avg_topic_data)

avg_topic_data %>%
  kbl(caption = "Average Attendance Per Meeting Topic") %>%
  kable_styling()
```
:::

# Individual Attendance

## Number of Meetings Attended
 
```{r}
#| label: num-meetings

indiv_atten <- wistem_attendance_data %>%
  filter(!is.na(full_name)) %>% 
  count(full_name) %>%
  mutate(
    proportion = n / sum(n), 
    percent = proportion * 100
  ) %>% 
  arrange(desc(percent))

cat_indiv_atten <- indiv_atten %>%
  count(n) %>%
  rename(num_meetings = n, num_students = nn) %>%
  mutate(
    proportion = num_students / sum(num_students), 
    percent = proportion * 100
  ) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    num_students = as_factor(num_students)
    )

# Graph
ggplot(data = cat_indiv_atten, mapping = aes(x = num_meetings, y = num_students)) + 
  geom_col(color = color, fill = fill) + 
  geom_text(
    mapping = aes(label = num_students), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Number of Meetings Attended by Unique Students", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

# Average Number
indiv_atten %>%
  rename(num_meetings = n) %>%
  summarize(
    min = min(num_meetings), 
    median = median(num_meetings), 
    mean = mean(num_meetings), 
    std_dev = sd(num_meetings),
    max = max(num_meetings), 
    range = max - min
  ) %>%
  kbl(caption = "Summary of Number of Meetings Attended") %>%
  kable_styling()
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended
```{r}
# Table
cat_indiv_atten %>% 
  arrange(desc(percent)) %>%
  kbl(caption = "Number of Meetings Attended by Unique Students") %>%
  kable_styling()
```
:::


## Only One Meeting Attended
 
```{r}
#| label: one-meeting-attnd

meeting_one_attend <- wistem_attendance_data %>%
  filter(num_meetings == 1) %>%
  select(date, topic, num_meetings) %>%
  count(date) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

# Graph
ggplot(data = meeting_one_attend, mapping = aes(x = date, y = num_students)) + 
  geom_col(color = color, fill = fill) + 
  labs(
    title = "Number of Students Per Meeting Who Attended Only One Meeting",
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Meeting Date", 
    y = "Number of Students"
    ) + 
  geom_text(
    mapping = aes(label = num_students), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +
  scale_x_discrete(guide = guide_axis(angle = 90)) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Only One Meeting Attended
```{r}
# Table
meeting_one_attend %>%
  kbl(caption = "Number of Student Per Meetings Who Only Attended Once") %>%
  kable_styling()
```
:::

## One Meeting and Federal Race
 
```{r}
#| label: fed-race-one-meeting-attnd

one_meeting_fed_race <- wistem_attendance_data %>%
  filter(!is.na(race)) %>% 
  filter(num_meetings == 1) %>%
  select(num_meetings, race) %>%
  mutate(num_meetings = as_factor(num_meetings)) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

# Graph for All
ggplot(data = one_meeting_fed_race, mapping = aes(x = race, y = num_students, fill = race)) +
  geom_col() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    mapping = aes(label = paste0(round(percent, 1), "%")), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +
  scale_x_discrete(guide = guide_axis(angle = 90)) + 
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting", 
    subtitle = "By All Federal Races (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

# Considering White and Non-White
one_meeting_fed_race_two <- wistem_attendance_data %>%
  filter(!is.na(white_non_white)) %>% 
  filter(num_meetings == 1) %>%
  select(num_meetings, white_non_white) %>%
  mutate(num_meetings = as_factor(num_meetings)) %>% 
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

## Graph
ggplot(data = one_meeting_fed_race_two, mapping = aes(x = white_non_white, y = num_students, fill = white_non_white)) +
  geom_col() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    mapping = aes(label = paste0(round(percent, 1), "%")), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race and Only One Meeting Attended
```{r}
# Table
one_meeting_fed_race %>%
  kbl(caption = "Federal Race and Students Who Attended One Meeting") %>%
  kable_styling()

one_meeting_fed_race_two %>%
  kbl(caption = "White & Non-White and Students Who Attended One Meeting") %>%
  kable_styling()
```
:::


## One Meeting and Graduation Year

```{r}
#| label: grad-year-one-meeting-attnd

one_meeting_grad_year <- wistem_attendance_data %>%
  filter(!is.na(grad_year)) %>% 
  filter(num_meetings == 1) %>%
  select(num_meetings, grad_year) %>%
  mutate(grad_year = as_factor(grad_year)) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

# Graph
ggplot(data = one_meeting_grad_year, mapping = aes(x = grad_year, y = num_students, fill = grad_year)) +
  geom_col() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    mapping = aes(label = num_students), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting", 
    subtitle = "By Graduation Year (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year and Only One Meeting Attended
```{r}
# Table
one_meeting_grad_year %>%
  kbl(caption = "Graduation Year and Students Who Attended One Meeting") %>%
  kable_styling()
```
:::

## One Meeting and Topic

```{r}
#| label: topic-one-meeting-attnd

one_meeting_topic <- wistem_attendance_data %>%
  filter(num_meetings == 1) %>%
  select(num_meetings, topic) %>%
  mutate(topic = as_factor(topic)) %>%
  count(topic) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

# Graph
ggplot(data = one_meeting_topic, mapping = aes(y = topic, x = num_students, fill = topic)) +
  geom_col() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    mapping = aes(label = num_students), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting", 
    subtitle = "By Topic (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Topic", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Topic and Only One Meeting Attended
```{r}
# Table
one_meeting_grad_year %>%
  kbl(caption = "Topic and Students Who Attended One Meeting") %>%
  kable_styling()
```
:::

# Distribution Per Meeting

## September 29, 2023
**Topic: Activity**
```{r}
#| label: sep-29-dist

sep_29_data <- wistem_attendance_data %>%
  filter(date == "Sep 29th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: sep-29-num-meetings

# Graph
ggplot(data = sep_29_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for September 29th
```{r}
# Table
sep_29_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: sep-29-grad-year

# Graph
ggplot(data = sep_29_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for September 29th
```{r}
# Table
sep_29_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: sep-29-race

# Graph
ggplot(data = sep_29_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for September 29th
```{r}
# Table
sep_29_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: sep-29-two-race

## Graph
ggplot(data = sep_29_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for September 29th
```{r}
# Table
sep_29_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## October 13, 2023
**Topic: Activity**
```{r}
#| label: oct-13-dist

oct_13_data <- wistem_attendance_data %>%
  filter(date == "Oct 13th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: oct-13-num-meetings

# Graph
ggplot(data = oct_13_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for October 13th
```{r}
# Table
oct_13_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: oct-13-grad-year

# Graph
ggplot(data = oct_13_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for October 13th
```{r}
# Table
oct_13_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: oct-13-race

# Graph
ggplot(data = oct_13_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for October 13th
```{r}
# Table
oct_13_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: oct-13-two-race

## Graph
ggplot(data = oct_13_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for October 13th
```{r}
# Table
oct_13_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## October 27, 2023
**Topic: Activity**
```{r}
#| label: oct-27-dist

oct_27_data <- wistem_attendance_data %>%
  filter(date == "Oct 27th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: oct-27-num-meetings

# Graph
ggplot(data = oct_27_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for October 27th
```{r}
# Table
oct_27_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: oct-27-grad-year

# Graph
ggplot(data = oct_27_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for October 27th
```{r}
# Table
oct_27_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: oct-27-race

# Graph
ggplot(data = oct_27_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for October 27th
```{r}
# Table
oct_27_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: oct-27-two-race

## Graph
ggplot(data = oct_27_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for October 27th
```{r}
# Table
oct_27_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## November 15, 2023
**Topic: Outside of School Event**
```{r}
#| label: nov-15-dist

nov_15_data <- wistem_attendance_data %>%
  filter(date == "Nov 15th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: nov-15-num-meetings

# Graph
ggplot(data = nov_15_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for November 15th
```{r}
# Table
nov_15_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: nov-15-grad-year

# Graph
ggplot(data = nov_15_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for November 15th
```{r}
# Table
nov_15_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: nov-15-race

# Graph
ggplot(data = nov_15_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for November 15th
```{r}
# Table
nov_15_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: nov-15-two-race

## Graph
ggplot(data = nov_15_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for November 15th
```{r}
# Table
nov_15_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## November 17, 2023
**Topic: Guest Speaker with Activity**
```{r}
#| label: nov-17-dist

nov_17_data <- wistem_attendance_data %>%
  filter(date == "Nov 17th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: nov-17-num-meetings

# Graph
ggplot(data = nov_17_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for November 17th
```{r}
# Table
nov_17_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: nov-17-grad-year

# Graph
ggplot(data = nov_17_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for November 17th
```{r}
# Table
nov_17_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: nov-17-race

# Graph
ggplot(data = nov_17_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for November 17th
```{r}
# Table
nov_17_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: nov-17-two-race

## Graph
ggplot(data = nov_17_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for November 17th
```{r}
# Table
nov_17_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## December 1, 2023
**Topic: Discussion**
```{r}
#| label: dec-1-dist

dec_1_data <- wistem_attendance_data %>%
  filter(date == "Dec 1st") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: dec-1-num-meetings

# Graph
ggplot(data = dec_1_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for December 1st
```{r}
# Table
dec_1_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: dec-1-grad-year

# Graph
ggplot(data = dec_1_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for December 1st
```{r}
# Table
dec_1_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: dec-1-race

# Graph
ggplot(data = dec_1_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for December 1st
```{r}
# Table
dec_1_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: dec-1-two-race

## Graph
ggplot(data = dec_1_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for December 1st
```{r}
# Table
dec_1_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## December 15, 2023
**Topic: Hangout**
```{r}
#| label: dec-15-dist

dec_15_data <- wistem_attendance_data %>%
  filter(date == "Dec 15th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: dec-15-num-meetings

# Graph
ggplot(data = dec_15_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for December 15th
```{r}
# Table
dec_15_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: dec-15-grad-year

# Graph
ggplot(data = dec_15_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for December 15th
```{r}
# Table
dec_15_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: dec-15-race

# Graph
ggplot(data = dec_15_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for December 15th
```{r}
# Table
dec_15_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: dec-15-two-race

## Graph
ggplot(data = dec_15_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for December 15th
```{r}
# Table
dec_15_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## January 19, 2024
**Topic: Guest Speakers with Activity**
```{r}
#| label: jan-19-dist

jan_19_data <- wistem_attendance_data %>%
  filter(date == "Jan 19th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: jan-19-num-meetings

# Graph
ggplot(data = jan_19_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for January 19th
```{r}
# Table
jan_19_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: jan-19-grad-year

# Graph
ggplot(data = jan_19_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for January 19th
```{r}
# Table
jan_19_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: jan-19-race

# Graph
ggplot(data = jan_19_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for January 19th
```{r}
# Table
jan_19_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: jan-19-two-race

## Graph
ggplot(data = jan_19_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for January 19th
```{r}
# Table
jan_19_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## February 16, 2024
**Topic: Activity**
```{r}
#| label: feb-16-dist

feb_16_data <- wistem_attendance_data %>%
  filter(date == "Feb 16th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: feb-16-num-meetings

# Graph
ggplot(data = feb_16_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for February 16th
```{r}
# Table
feb_16_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: feb-16-grad-year

# Graph
ggplot(data = feb_16_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for February 16th
```{r}
# Table
feb_16_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: feb-16-race

# Graph
ggplot(data = feb_16_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for February 16th
```{r}
# Table
feb_16_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: feb-16-two-race

## Graph
ggplot(data = feb_16_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for February 16th
```{r}
# Table
feb_16_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## March 1, 2024
**Topic: Activity**
```{r}
#| label: mar-1-dist

mar_1_data <- wistem_attendance_data %>%
  filter(date == "Mar 1st") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: mar-1-num-meetings

# Graph
ggplot(data = mar_1_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for March 1st
```{r}
# Table
mar_1_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: mar-1-grad-year

# Graph
ggplot(data = mar_1_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for March 1st
```{r}
# Table
mar_1_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: mar-1-race

# Graph
ggplot(data = mar_1_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for March 1st
```{r}
# Table
mar_1_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: mar-1-two-race

## Graph
ggplot(data = mar_1_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for March 1st
```{r}
# Table
mar_1_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## March 15, 2024
**Topic: Activity**
```{r}
#| label: mar-15-dist

mar_15_data <- wistem_attendance_data %>%
  filter(date == "Mar 15th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: mar-15-num-meetings

# Graph
ggplot(data = mar_15_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for March 15th
```{r}
# Table
mar_15_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: mar-15-grad-year

# Graph
ggplot(data = mar_15_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for March 15th
```{r}
# Table
mar_15_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: mar-15-race

# Graph
ggplot(data = mar_15_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for March 15th
```{r}
# Table
mar_15_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: mar-15-two-race

## Graph
ggplot(data = mar_15_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for March 15th
```{r}
# Table
mar_15_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## April 5, 2024
**Topic: Guest Speakers with Activity**
```{r}
#| label: apr-5-dist

apr_5_data <- wistem_attendance_data %>%
  filter(date == "Apr 5th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: apr-5-num-meetings

# Graph
ggplot(data = apr_5_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for April 5th
```{r}
# Table
apr_5_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: apr-5-grad-year

# Graph
ggplot(data = apr_5_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for April 5th
```{r}
# Table
apr_5_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: apr-5-race

# Graph
ggplot(data = apr_5_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for April 5th
```{r}
# Table
apr_5_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: apr-5-two-race

## Graph
ggplot(data = apr_5_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for April 5th
```{r}
# Table
apr_5_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## April 19, 2024
**Topic: Activity**
```{r}
#| label: apr-19-dist

apr_19_data <- wistem_attendance_data %>%
  filter(date == "Apr 19th") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: apr-19-num-meetings

# Graph
ggplot(data = apr_19_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for April 19th
```{r}
# Table
apr_19_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: apr-19-grad-year

# Graph
ggplot(data = apr_19_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for April 19th
```{r}
# Table
apr_19_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: apr-19-race

# Graph
ggplot(data = apr_19_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for April 19th
```{r}
# Table
apr_19_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: apr-19-two-race

## Graph
ggplot(data = apr_19_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for April 19th
```{r}
# Table
apr_19_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

## May 3, 2024
**Topic: Activity**
```{r}
#| label: may-3-dist

may_3_data <- wistem_attendance_data %>%
  filter(date == "May 3rd") %>%
  select(date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    num_meetings = as_factor(num_meetings), 
    grad_year = as_factor(grad_year), 
    race = as_factor(race)
    )
```

```{r}
#| label: may-3-num-meetings

# Graph
ggplot(data = may_3_data, mapping = aes(x = num_meetings)) + 
  geom_bar(color = color, fill = fill) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Attendance Distribution By Number of Meetings Attended", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students"
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Number of Meetings Attended for May 3rd
```{r}
# Table
may_3_data %>%
  select(date, num_meetings) %>%
  count(num_meetings) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Number of Meetings Attended") %>%
  kable_styling()
```
:::

```{r}
#| label: may-3-grad-year

# Graph
ggplot(data = may_3_data, mapping = aes(x = grad_year, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year for May 3rd
```{r}
# Table
may_3_data %>%
  select(date, grad_year) %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Attendance Distribution By Graduation Year") %>%
  kable_styling()
```
:::

```{r}
#| label: may-3-race

# Graph
ggplot(data = may_3_data, mapping = aes(x = race, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    stat = "count", 
    mapping = aes(label = ..count..), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Distribution By Race", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race for May 3rd
```{r}
# Table
may_3_data %>%
  select(date, race) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By Federal Race") %>%
  kable_styling()
```
:::

```{r}
#| label: may-3-two-race

## Graph
ggplot(data = may_3_data, mapping = aes(x = white_non_white, fill = white_non_white)) +
  geom_bar() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    stat = "count", 
    mapping = aes(label = paste0(round(after_stat(count / sum(count) * 100), 1), "%")),
    position = position_stack(vjust = 0.5),
    family = "Georgia",
    fontface = "bold"
  ) +
  labs(
    title = "Number of Students Per Meeting Who Attended One Meeting",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position ="top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for White & Non-White for May 3rd
```{r}
# Table
may_3_data %>%
  select(date, white_non_white) %>%
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "Distribution By White & Non-White") %>%
  kable_styling()
```
:::

# Attendance by Graduation Year

## Total Grade Distribution
```{r}
#| label: grade-dist

grade_distribution <- wistem_attendance_data %>%
  select(id, date, topic, num_meetings, grad_year, grade, race, white_non_white) %>%
  filter(!is.na(grad_year)) %>%
  mutate(
    grad_year = as_factor(grad_year), 
    num_meetings = as_factor(num_meetings), 
    race = as_factor(race), 
    grade = as_factor(grade)
    ) 

# Repeated
grade_repeat <- grade_distribution %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

## Graph
grade_repeat_graph <- ggplot(data = grade_repeat, mapping = aes(x = grad_year, y = num_students, fill = grad_year)) + 
  geom_col() + 
  geom_text(
    mapping = aes(label = num_students), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia",
    fontface = "bold"
    ) + 
  scale_fill_manual(values = unique_colors) + 
  labs(
    title = "Graduation Year", 
    subtitle = "With Repeats",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "none", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

# Unique
grade_unique <- grade_distribution %>%
  select(id, num_meetings, grad_year, race) %>%
  unique() %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

## Graph
grade_unique_graph <- ggplot(data = grade_unique, mapping = aes(x = grad_year, y = num_students, fill = grad_year)) + 
  geom_col() + 
  geom_text(
    mapping = aes(label = num_students), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia",
    fontface = "bold"
    ) + 
  scale_fill_manual(values = unique_colors) + 
  labs(
    title = "Graduation Year", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Graduation Year", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "right", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

# Combining
grade_repeat_graph + grade_unique_graph
```

::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year of All Students (With Repeats)
```{r}
## Table
grade_repeat %>%
  kbl(caption = "Graduation Year of All Students (With Repeats)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year of All Students (Unique)
```{r}
## Table
grade_unique %>%
  kbl(caption = "Graduation Year of All Students (Unique)") %>%
  kable_styling()
```
:::


## Comparing Grade Distributions with ETHS

Obtained ETHS Data from the following [report](https://il01903927.schoolwires.net/site/handlers/filedownload.ashx?moduleinstanceid=2864&dataid=3599&FileName=ETHS_SchoolProfile2023-24.pdf)
```{r}
#| label: compare-grade-dist

eths_grade <- tibble(
  grad_year = c(2027, 2026, 2025, 2024), 
  num_students = c(932, 853, 973, 835), 
  prop = num_students / sum(num_students), 
  percent = prop * 100
) %>%
  mutate(program = "eths") %>%
  select(program, grad_year, num_students, prop, percent) %>%
  mutate(grad_year = as_factor(grad_year))

wistem_grade <- wistem_attendance_data %>%
  filter(!is.na(grad_year)) %>% 
  select(full_name, id, grad_year) %>%
  unique() %>%
  count(grad_year) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  mutate(program = "wistem") %>%
  select(program, grad_year, num_students, prop, percent) %>%
  arrange(desc(grad_year)) %>%
  mutate(grad_year = as_factor(grad_year))

compare_grade_dist <- full_join(eths_grade, wistem_grade)

# Graphs
## WiSTEM
wistem_grade_dist <- ggplot(data = wistem_grade, mapping = aes(y = grad_year, x = num_students, fill = grad_year)) + 
  geom_col() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    mapping = aes(label = sprintf("%.2f%%", percent)), 
    position = position_stack(vjust = 0.5), size = 3, 
    family = "Georgia",
    fontface = "bold"
    ) + 
  labs(
    title = "WiSTEM Grade Distribution", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    y = "Graduation Year", 
    x = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "none", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

## ETHS
eths_grade_dist <- ggplot(data = eths_grade, mapping = aes(y = grad_year, x = num_students, fill = grad_year)) + 
  geom_col() + 
  scale_fill_manual(values = unique_colors) + 
  geom_text(
    mapping = aes(label = sprintf("%.2f%%", percent)), 
    position = position_stack(vjust = 0.5), size = 3, 
    family = "Georgia",
    fontface = "bold"
    ) + 
  labs(
    title = "ETHS Grade Distribution", 
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    y = "Graduation Year", 
    x = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "right", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

## Combining
wistem_grade_dist + eths_grade_dist
```

::: {.callout-note icon=false collapse="true"}
## Table for Comparing Grade Distributions Between WiSTEM and ETHS
```{r}
# Table
compare_grade_dist %>%
  kbl(caption = "Comparing Grade Distributions (Unique)") %>%
  kable_styling()
```
:::

## Graduation Year and Number of Meetings
```{r}
#| label: grade-num-meetings

grade_num_meetings <- grade_distribution %>%
  select(id, num_meetings, grad_year, race) %>%
  unique() %>%
  select(-id)

grade_num_meetings_table <- grade_distribution %>%
  select(id, num_meetings, grad_year, race) %>%
  unique() %>%
  select(-id, -race) %>%
  group_by(grad_year, num_meetings) %>%
  summarize(num_students = n())

grade_num_meetings_table <- pivot_wider(grade_num_meetings_table, names_from = grad_year, values_from = num_students)

# Graph
ggplot(data = grade_num_meetings, mapping = aes(x = num_meetings, fill = grad_year)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  labs(
    title = "Graduation Year and Number of Meetings",
    subtitle = "Unique Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year and Number of Meetings Attended
```{r}
# Table
grade_num_meetings_table %>%
  kbl(caption = "Graduation Year and Number of Meetings Attended (Unique)") %>%
  kable_styling()
```
:::

## Graduation Year and Federal Race
```{r}
#| label: grade-federal-race

grade_race <- grade_distribution %>%
  select(id, num_meetings, grad_year, race) %>%
  unique() %>%
  select(-id)

grade_race_table <- grade_distribution %>%
  select(id, num_meetings, grad_year, race) %>%
  unique() %>%
  select(-id, -num_meetings) %>%
  group_by(grad_year, race) %>%
  summarize(num_students = n()) %>%
  mutate(num_students = num_students)

# Graph
ggplot(data = grade_race, mapping = aes(x = race, fill = grad_year)) + 
  geom_bar(position = "dodge") + 
  scale_fill_manual(values = unique_colors) + 
  labs(
    title = "Graduation Year and Federal Race",
    subtitle = "By All Federal Races (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

# Only Two Categories
grade_race_two <- grade_distribution %>%
  select(id, num_meetings, grad_year, white_non_white) %>%
  unique() %>%
  select(-id)

grade_race_table_two <- grade_race_two %>%
  select(-num_meetings) %>%
  group_by(grad_year, white_non_white) %>%
  summarize(num_students = n()) %>%
  mutate(num_students = num_students)

## Graph
ggplot(data = grade_race_two, mapping = aes(x = white_non_white, fill = grad_year)) + 
  geom_bar(position = "dodge") + 
  scale_fill_manual(values = unique_colors) + 
  labs(
    title = "Graduation Year and Federal Race",
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year and Federal Race (Simple)
```{r}
# Table
grade_race_table_wider <- pivot_wider(grade_race_table, names_from = race, values_from = num_students) %>%
  select(grad_year, White, Black, Asian, Hispanic, ToM)

grade_race_table_wider %>%
  kbl(caption = "Graduation Year and Federal Race (Unique)") %>%
  kable_styling()

grade_race_table_two_wider <- pivot_wider(grade_race_table_two, names_from = white_non_white, values_from = num_students)

grade_race_table_two_wider %>%
  kbl(caption = "Graduation Year and Federal Race (Unique)") %>%
  kable_styling()
```
:::


::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year and Federal Race (By Year)

::: {.callout-note icon=false collapse="true"}
## Table for 2024 Graduation Year and Federal Race
```{r}
# Table
grade_race_table %>%
  filter(grad_year == "2024") %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "2024 Graduation Year and Federal Race (Unique)") %>%
  kable_styling()

grade_race_table_two %>%
  filter(grad_year == "2024") %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "2024 Graduation Year and Federal Race (Unique)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for 2025 Graduation Year and Federal Race
```{r}
# Table
grade_race_table %>%
  filter(grad_year == "2025") %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "2025 Graduation Year and Federal Race (Unique)") %>%
  kable_styling()

grade_race_table_two %>%
  filter(grad_year == "2025") %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "2025 Graduation Year and Federal Race (Unique)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for 2026 Graduation Year and Federal Race
```{r}
# Table
grade_race_table %>%
  filter(grad_year == "2026") %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "2026 Graduation Year and Federal Race (Unique)") %>%
  kable_styling()

grade_race_table_two %>%
  filter(grad_year == "2026") %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "2026 Graduation Year and Federal Race (Unique)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for 2027 Graduation Year and Federal Race
```{r}
# Table
grade_race_table %>%
  filter(grad_year == "2027") %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "2027 Graduation Year and Federal Race (Unique)") %>%
  kable_styling()

grade_race_table_two %>%
  filter(grad_year == "2027") %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  kbl(caption = "2027 Graduation Year and Federal Race (Unique)") %>%
  kable_styling()
```
:::

:::

## Graduation Year and Topic
```{r}
#| label: grade-topic

grade_topic <- grade_distribution %>%
  group_by(topic, grad_year) %>%
  summarize(num_students = n()) %>%
  select(grad_year, topic, num_students) %>%
  mutate(num_students = num_students)

total_repeat_students_grade <- grade_topic %>% 
  group_by(grad_year) %>% 
  summarize(sum = sum(num_students), .groups = "drop")

grade_topic <- left_join(grade_topic, total_repeat_students_grade, by = "grad_year")

# Graph 
ggplot(data = grade_topic, mapping = aes(x = topic, y = num_students, fill = grad_year)) + 
  geom_col(position = "dodge") + 
  scale_fill_manual(values = unique_colors) + 
  labs(
    title = "Graduation Year and Topic",
    subtitle = "With Repeats",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  scale_x_discrete(guide = guide_axis(angle = 90)) +
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year and Topic (Simple)
```{r}
# Table
grade_topic_table <- pivot_wider(grade_topic, names_from = topic, values_from = num_students)

grade_topic_table %>%
  kbl(caption = "Graduation Year and Topic (With Repeats)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for Graduation Year and Topic (By Year)

::: {.callout-note icon=false collapse="true"}
## Table for 2024 Graduation Year and Topic
```{r}
# Table
grade_topic %>%
  filter(grad_year == "2024") %>%
  mutate(
    prop = num_students / sum, 
    percent = prop * 100
  ) %>%
  kbl(caption = "2024 Graduation Year and Topic (With Repeats)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for 2025 Graduation Year and Topic
```{r}
# Table
grade_topic %>%
  filter(grad_year == "2025") %>%
  mutate(
    prop = num_students / sum, 
    percent = prop * 100
  ) %>%
  kbl(caption = "2025 Graduation Year and Topic (With Repeats)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for 2026 Graduation Year and Topic
```{r}
# Table
grade_topic %>%
  filter(grad_year == "2026") %>%
  mutate(
    prop = num_students / sum, 
    percent = prop * 100
  ) %>%
  kbl(caption = "2026 Graduation Year and Topic (With Repeats)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for 2027 Graduation Year and Topic
```{r}
# Table
grade_topic %>%
  filter(grad_year == "2027") %>%
  mutate(
    prop = num_students / sum, 
    percent = prop * 100
  ) %>%
  kbl(caption = "2027 Graduation Year and Topic (With Repeats)") %>%
  kable_styling()
```
:::

:::

# Attendance by Federal Race

## Total Race Distribution

```{r}
#| label: total-race-dist

race_dist_unique <- wistem_attendance_data %>%
  filter(!is.na(race)) %>% 
  select(race, id, num_meetings) %>%
  unique() %>%
  select(-id) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

# Graph
ggplot(data = race_dist_unique, mapping = aes(x = race, y = num_students, fill = race)) +
  geom_col() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    mapping = aes(label = paste0(round(percent, 1), "%")), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia",
    fontface = "bold"
    ) + 
  labs(
    title = "Federal Race Distribution", 
    subtitle = "By All Federal Races (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

# Only Two Categories
race_dist_unique_two <- wistem_attendance_data %>%
  filter(!is.na(white_non_white)) %>% 
  select(white_non_white, id, num_meetings) %>%
  unique() %>%
  select(-id) %>% 
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

## Graph
ggplot(data = race_dist_unique_two, mapping = aes(x = white_non_white, y = num_students, fill = white_non_white)) +
  geom_col() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    mapping = aes(label = paste0(round(percent, 1), "%")), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia",
    fontface = "bold"
    ) + 
  labs(
    title = "Federal Race Distribution", 
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Total Race Distribution
```{r}
# Table
race_dist_unique %>%
  kbl(caption = "Federal Race Distribution (Unique)") %>%
  kable_styling()

race_dist_unique_two %>%
  kbl(caption = "Federal Race Distribution With Only White and Non-White (Unique)") %>%
  kable_styling()
```
:::

## Race Distribution Without One-Timers
```{r}
#| label: race-dist-without-one-timers

race_without_one <- wistem_attendance_data %>%
  filter(num_meetings != 1) %>%
  filter(!is.na(race)) %>% 
  select(race, id, num_meetings) %>%
  unique() %>%
  select(-id) %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

# Graph 
ggplot(data = race_without_one, mapping = aes(x = race, y = num_students, fill = race)) +
  geom_col() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    mapping = aes(label = paste0(round(percent, 1), "%")), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia",
    fontface = "bold"
    ) + 
  labs(
    title = "Federal Race Distribution (Without One-Timers)", 
    subtitle = "By All Federal Races (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students"
) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

# Only Two Categories
race_without_one_two <- wistem_attendance_data %>%
  filter(!is.na(white_non_white)) %>% 
  filter(num_meetings != 1) %>%
  select(white_non_white, id, num_meetings) %>%
  unique() %>%
  select(-id) %>% 
  count(white_non_white) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  )

## Graph
ggplot(data = race_without_one_two, mapping = aes(x = white_non_white, y = num_students, fill = white_non_white)) +
  geom_col() + 
  scale_fill_manual(values = unique_colors) +
  geom_text(
    mapping = aes(label = paste0(round(percent, 1), "%")), 
    position = position_stack(vjust = 0.5), 
    family = "Georgia",
    fontface = "bold"
    ) + 
  labs(
    title = "Federal Race Distribution (Without One-Timers)", 
    subtitle = "By White and Non-White Students (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students",
    fill = ""
  ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Total Race Distribution Without One-Timers
```{r}
# Table
race_without_one %>%
  kbl(caption = "Federal Race Distribution Without One-Timers (Unique)") %>%
  kable_styling()

race_without_one_two %>%
  kbl(caption = "Federal Race Distribution Without One-Timers (Only White and Non-White; Unique)") %>%
  kable_styling()
```
:::


## Comparing Race Distributions with ETHS

Obtained ETHS Data from the following [report](https://www.eths.k12.il.us/site/handlers/filedownload.ashx?moduleinstanceid=1490&dataid=8803&FileName=Opening%20School%20Report_FINAL_SY2024.pdf)
```{r}
#| label: compare-race-dist

eths_race <- tibble(
  race = c("White", "Asian", "Black", "Hispanic", "ToM"),
  num_students = c(1596, 162, 867, 725, 229), 
  prop = num_students / sum(num_students), 
  percent = prop * 100
) %>%
  mutate(program = "eths") %>%
  select(program, race, num_students, prop, percent) %>% 
  mutate(white_non_white = ifelse(race == "White", "White", "Non-White"))

wistem_race <- wistem_attendance_data %>%
  filter(!is.na(race)) %>% 
  select(full_name, id, race, white_non_white) %>%
  unique() %>%
  count(race) %>%
  rename(num_students = n) %>%
  mutate(
    prop = num_students / sum(num_students), 
    percent = prop * 100
  ) %>%
  mutate(program = "wistem") %>%
  select(program, race, num_students, prop, percent) %>%
  arrange(desc(race)) %>% 
  mutate(white_non_white = ifelse(race == "White", "White", "Non-White"))

compare_race_dist <- full_join(eths_race, wistem_race)

# Graphs
## WiSTEM
wistem_race_dist <- ggplot(data = wistem_race, mapping = aes(x = race, y = num_students, fill = race)) + 
  geom_col() + 
  scale_fill_manual(values = unique_colors) + 
  scale_x_discrete(guide = guide_axis(angle = 90)) + 
  labs(
    title = "WiSTEM Race Distribution", 
    subtitle = "By All Federal Races (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "none", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

## ETHS
eths_race_dist <- ggplot(data = eths_race, mapping = aes(x = race, y = num_students, fill = race)) + 
  geom_col() + 
  scale_fill_manual(values = unique_colors) + 
  scale_x_discrete(guide = guide_axis(angle = 90)) + 
  labs(
    title = "ETHS Race Distribution", 
    subtitle = "By All Federal Races (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "right", 
    legend.text = element_text(family = "Georgia", size = 12), 
    axis.title = element_text(family = "Georgia", size = 12), 
    axis.text = element_text(family = "Georgia", size = 10), 
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

## Combining
wistem_race_dist + eths_race_dist

## Combined Percentage Graph
ggplot(data = compare_race_dist, aes(x = race, y = percent, fill = program)) + 
  geom_col(position = "dodge") +  
  scale_fill_manual(values = unique_colors, labels = c("eths" = "ETHS", "wistem" = "WiSTEM")) + 
  geom_text(
    mapping = aes(label = sprintf("%.1f%%", percent)), 
    position = position_dodge(width = 0.9), 
    vjust = -0.5,
    size = 3,
    family = "Georgia", 
    fontface = "bold"
    ) +  
  labs(
    title = "Comparison of Race Distribution: ETHS vs WiSTEM",
    subtitle = "Percentage of Students by Federal Race",
    caption = "Source: WiSTEM 2023-2024",
    x = "Federal Race",
    y = "Percentage of Students",
    fill = ""
  ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "right",
    legend.text = element_text(family = "Georgia", size = 12),
    axis.title = element_text(family = "Georgia", size = 12),
    axis.text = element_text(family = "Georgia", size = 10),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```


```{r}
#| label: compare-race-dist-two-cat

eths_race_two <- eths_race %>% 
  group_by(white_non_white) %>% 
  summarize(num_students = sum(num_students), .groups = "drop") %>% 
  mutate(
  prop = num_students / sum(num_students), 
  percent = prop * 100
  ) %>%
  mutate(program = "eths")

wistem_race_two <- wistem_race %>%
  group_by(white_non_white) %>% 
  summarize(num_students = sum(num_students), .groups = "drop") %>% 
  mutate(
  prop = num_students / sum(num_students), 
  percent = prop * 100
  ) %>%
  mutate(program = "wistem")

compare_race_dist_two <- full_join(eths_race_two, wistem_race_two)

# Graph
## Combined Percentage Graph
ggplot(data = compare_race_dist_two, aes(x = white_non_white, y = percent, fill = program)) + 
  geom_col(position = "dodge") +  
  geom_text(
    mapping = aes(label = sprintf("%.2f%%", percent)), 
    position = position_dodge(width = 0.9), 
    vjust = -0.5, 
    size = 4, 
    family = "Georgia", 
    fontface = "bold"
    ) +  
  scale_fill_manual(values = unique_colors, labels = c("eths" = "ETHS", "wistem" = "WiSTEM")) +
  labs(
    title = "Comparison of Race Distribution: ETHS vs WiSTEM",
    subtitle = "Percentage of White and Non-White Students",
    caption = "Source: WiSTEM 2023-2024",
    x = "Race Category",
    y = "Percentage of Students",
    fill = ""
  ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "right",
    legend.text = element_text(family = "Georgia", size = 12),
    axis.title = element_text(family = "Georgia", size = 12),
    axis.text = element_text(family = "Georgia", size = 10),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )
```

::: {.callout-note icon=false collapse="true"}
## Table for Comparing Race Distributions Between WiSTEM and ETHS (All Categories)
```{r}
# Table
compare_race_dist %>%
  kbl(caption = "Comparing Race Distributions (All Federal Race Categories) (Unique)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for Comparing Race Distributions Between WiSTEM and ETHS (White and Non-White)
```{r}
# Table
compare_race_dist_two %>%
  kbl(caption = "Comparing Race Distributions (White and Non-White) (Unique)") %>%
  kable_styling()
```
:::

## Race and Number of Meetings
```{r}
#| label: race-and-num-meetings

race_distribution <- wistem_attendance_data %>%
  filter(!is.na(race)) %>% 
  select(id, date, topic, num_meetings, grad_year, race, white_non_white) %>%
  mutate(
    grad_year = as_factor(grad_year), 
    num_meetings = as_factor(num_meetings), 
    race = as_factor(race)
    )

race_num_meetings <- race_distribution %>%
  select(id, num_meetings, grad_year, race) %>%
  unique() %>%
  select(-id, -grad_year)

race_num_meetings_table <- race_num_meetings %>%
  group_by(race, num_meetings) %>%
  summarize(num_students = n())

# Graph
race_num_meetings_graph <- ggplot(data = race_num_meetings, mapping = aes(x = num_meetings, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  labs(
    title = "Federal Race and Number of Meetings",
    subtitle = "By All Federal Races (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top",
    legend.text = element_text(family = "Georgia", size = 12),
    axis.title = element_text(family = "Georgia", size = 12),
    axis.text = element_text(family = "Georgia", size = 10),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

## Only Two Categories
race_num_meetings_table_two <- race_distribution %>%
  group_by(white_non_white, num_meetings) %>%
  summarize(num_students = n())

race_num_meetings_graph_two <- ggplot(data = race_distribution, mapping = aes(x = num_meetings, fill = white_non_white)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  labs(
    title = "Federal Race and Number of Meetings",
    subtitle = "By White and Non-White (Unique Students)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Number of Meetings Attended", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top",
    legend.text = element_text(family = "Georgia", size = 12),
    axis.title = element_text(family = "Georgia", size = 12),
    axis.text = element_text(family = "Georgia", size = 10),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

race_num_meetings_graph
race_num_meetings_graph_two
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race and Number of Meeings Attended (All Categories)
```{r}
# Table
race_num_meetings_table %>%
  kbl(caption = "Race and Number of Meetings Attended (All Federal Race Categories) (Unique)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race and Number of Meeings Attended (White and Non-White)
```{r}
# Table
race_num_meetings_table_two %>%
  kbl(caption = "Race and Number of Meetings Attended (White and Non-White) (Unique)") %>%
  kable_styling()
```
:::

## Race and Topic
```{r}
#| label: race-and-topic

race_topic <- race_distribution %>%
  select(race, topic)

race_topic_table <- race_topic %>%
  group_by(race, topic) %>%
  summarize(num_students = n())

# Graph
race_topic_graph <- ggplot(data = race_topic, mapping = aes(x = topic, fill = race)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  scale_x_discrete(guide = guide_axis(angle = 90)) +
  labs(
    title = "Federal Race and Topic",
    subtitle = "By All Federal Races (With Repeats)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Topic", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top",
    legend.text = element_text(family = "Georgia", size = 12),
    axis.title = element_text(family = "Georgia", size = 12),
    axis.text = element_text(family = "Georgia", size = 10),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

## Only Two Categories
race_topic_two <- race_distribution %>%
  select(white_non_white, topic)

race_topic_table_two <- race_topic_two %>%
  group_by(white_non_white, topic) %>%
  summarize(num_students = n())

race_topic_graph_two <- ggplot(data = race_topic_two, mapping = aes(x = topic, fill = white_non_white)) + 
  geom_bar() + 
  scale_fill_manual(values = unique_colors) + 
  scale_x_discrete(guide = guide_axis(angle = 90)) +
  labs(
    title = "Federal Race and Topic",
    subtitle = "By White and Non-White (With Repeats)",
    caption = "Source: WiSTEM 2023-2024",
    x = "Topic", 
    y = "Number of Students", 
    fill = ""
    ) + 
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, family = "Georgia", face = "bold"),
    plot.subtitle = element_text(hjust = 0.5, family = "Georgia"),
    legend.position = "top",
    legend.text = element_text(family = "Georgia", size = 12),
    axis.title = element_text(family = "Georgia", size = 12),
    axis.text = element_text(family = "Georgia", size = 10),
    panel.grid.minor.y = element_blank(),
    panel.grid.major.x = element_blank(),
    panel.grid.minor.x = element_blank()
  )

race_topic_graph
race_topic_graph_two
```

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race and Topic (All Categories)
```{r}
# Table
race_topic_table %>%
  kbl(caption = "Race and Topic (All Federal Race Categories) (Unique)") %>%
  kable_styling()
```
:::

::: {.callout-note icon=false collapse="true"}
## Table for Federal Race and Topic (White and Non-White)
```{r}
# Table
race_topic_table_two %>%
  kbl(caption = "Race and Topic (White and Non-White) (Unique)") %>%
  kable_styling()
```
:::

